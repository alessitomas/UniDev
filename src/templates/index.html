<html>

<head>
  <meta charset="UTF-8">
  <script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
  <script type = "text/javascript" src = "{{ url_for('static', filename = 'js/terminal.js') }}" ></script>	
  <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
  <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
  <script type="module" src="https://cdn.jsdelivr.net/gh/vanillawc/wc-monaco-editor@1/index.js"></script>
  


  
  
  <link rel="stylesheet" href="{{ url_for('static', filename = 'css/terminal.css') }}">
  <link rel="icon" href="{{url_for ('static', filename = 'imagens/logo_pagina.png')}}">

  

  <style>

  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@500&display=swap');


    #app {
      display: flex;
      flex-direction: row;
      width: 100%;
      height: 100%;
      margin-left: auto;
      margin-right: auto;
    }

    #app h1 {
      padding: 15px;
      font-size: x-large;
      display: flex;
      justify-content: center;
      background-color: #3f51b5;
      font-family: 'Poppins', sans-serif;
      color: #f8f8f8;
    }

    #app .enunciado {
      padding: 15px;
      line-height: 2;
    }

    #code {
      height: 10rem;
      border: 1px solid;
      border-radius: 3px;
      flex: 1;
    }

    #run-tests {
      background-color: #5bcf4f;
      width: 10rem;
      align-self: end;
      margin-top: 10px;
      margin-bottom: 10px;
      border-radius: 7px;
    }

    #run-tests:hover {
      background-color: #74df5f;
      transition: 300ms;
    }

    #pytest-output {
      overflow-y: scroll;
      display: flex;
      font-size: 10px;
      flex-direction: column;
      width: 100%;
      height: 100%;
    }
    
    .esquerdo {
      float:left;
      display: flex;
      flex-direction: column;
      width: 33%;
      overflow-y: scroll;
    }
    .meio {
      display: flex;
      flex-direction: column;
      width: 33%;
    }
    .direito {
      float:right;
      display: flex;
      flex-direction: column;
      width: 33%;
    }

    #body_div{
      display: flex;
      flex-direction: row;
      width: 100%;
      height: 94%;
    }

    #some{
      height: 1%;
    }

    .rodape{
      background-color: #3f51b5;
      height: 6%;
      display: flex;
      flex-direction:row-reverse;
      display: flex;
      flex-direction: row;
      justify-content:space-between;
    }
    #next_button{
      margin-right: 20px;
      margin-left: 20px;
      color: #f8f8f8;
      font-family: 'Poppins',sans-serif;
      border-radius: 15px;
      width: 10rem;
      align-self: end;
      margin-top: 10px;
      margin-bottom: 10px;
      pointer-events: none;
    }

    .next_button:hover{
      background-color: #5c6bc0;
      transition: 300ms;
    }
    .progresso{
      display: flex;
      width: 200%;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size:small;
      color: #c4d2ff;
      font-family: 'Poppins',sans-serif;
    }
  </style>

  {%set x=y%}

  <py-env>
    - pytest
    - pytest-reportlog
    - paths:
      - ../static/main2.py
      - ../static/solution.py
      - ../static/test_1.py
  </py-env>
  <style>

    #app {
      display: flex;
      flex-direction: row;
      width: 100%;
      height: 100%;
      margin-left: auto;
      margin-right: auto;
    }

    #app h1 {
      padding: 15px;
      font-size: x-large;
      background-color: #c4d2ff;
    }

    #app .enunciado {
      padding: 15px;
      line-height: 2;
    }

    #code {
      height: 10rem;
      border: 1px solid;
      border-radius: 3px;
      flex: 1;
    }

    #run-tests {
      background-color: #b5ddad;
      width: 10rem;
      align-self: end;
      margin-top: 10px;
      margin-bottom: 10px;
    }

    #pytest-output {
      flex: 1;
      overflow-y: scroll;
    }
    .esquerdo {
      float:left;
      display: flex;
      flex-direction: column;
      width: 33%;
      overflow-y: scroll;
    }
    .meio {
      display: flex;
      flex-direction: column;
      width: 33%;
    }
    .direito {
      float:right;
      display: flex;
      flex-direction: column;
      width: 33%;
    }

    #body_div{
      display: flex;
      flex-direction: row;
      width: 100%;
      height: 94%;
    }

    #some{
      height: 1%;
    }

    .rodape{
      background-color: black;
      height: 6%;
      display: flex;
      flex-direction:row-reverse;
      display: flex;
      flex-direction: row;
      justify-content:space-between;
    }
    .next_button{
      margin-right: 20px;
      margin-left: 20px;

      background-color: #b5ddad;
      width: 10rem;
      align-self: end;
      margin-top: 10px;
      margin-bottom: 10px;
    }
    .progresso{
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size:small;
      color: #c4d2ff;
    }
  </style>
</head>
<body>
  <div id="body_div">
  <section id="app">
    <div class = "esquerdo">

      <h1> Exercício: <p id="titulo"></p></h1>
      <div class="enunciado">
        <p id="enunciado"></p>

      </div>
    </div>
    <div class = "meio">
    <wc-monaco-editor id="code" language="python"></wc-monaco-editor>
    
    <button id="run-tests">Rodar Testes</button>
    </div>
    <div class="direito">
      <pre id="pytest-output">
      </pre>
      <py-script id = "pytest-term"> 
      </py-script>|
    </div>
  </section>

  </div>
  <div class="rodape">
    <button onclick="voltar()" class="next_button">Voltar</button>
    <script>
      function voltar() {
        localStorage.setItem("primeira_vez", false);
        if (parseInt(localStorage.getItem('tela'))>1){
          localStorage.setItem("tela", parseInt(localStorage.getItem('tela'))-1);
        }

        window.location.reload()
      }
    </script>
    
    <div class="progresso">
      <h2>PROGRESSO</h2>
        <h3><a id="tela" ></a>/3</h3>
    </div>
    
    <button class="next_button" onclick="sendtela()" >Próximo</button>
    <script>
      function sendtela() {
        if (document.getElementById('code').value!="" && parseInt(localStorage.getItem('tela'))<= parseInt(localStorage.getItem('telas_curso_ativo')) ){
          window.location.reload();
          var xhr = new XMLHttpRequest();
          localStorage.setItem("primeira_vez", false);
          xhr.open("POST", 'http://127.0.0.1:5000/terminal/'+localStorage.getItem('id_user_ativo').toString()+'/curso/'+localStorage.getItem('id_curso_ativo').toString()+ '/exercicio/' +localStorage.getItem('tela').toString(), true);
          xhr.setRequestHeader('Content-Type', 'application/json');
          xhr.send(JSON.stringify({
          'exr': document.getElementById('code').value
        }));
        localStorage.setItem("tela", parseInt(localStorage.getItem('tela'))+1);
            }
        else{
          console.log("aquiiiiiiiiii");
            }
      }
    </script>
  </div> 
  <py-script src="{{url_for('static', filename='main2.py')}}" ouput="pytest-output" id="some">
  </py-script>

</body>
</html>